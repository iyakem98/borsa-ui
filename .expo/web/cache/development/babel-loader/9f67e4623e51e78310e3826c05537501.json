{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport messageService from \"./messageService\";\nvar initialState = {\n  messages: [],\n  isError: false,\n  isSuccess: false,\n  isLoading: false,\n  messages: []\n};\nexport var fetchMessages = createAsyncThunk('message/fetch', function () {\n  var _ref = _asyncToGenerator(function* (selectedChat, user, setLd, setMessages, socket) {\n    try {\n      return yield messageService.fetchMessages(selectedChat, user, setLd, setMessages, socket);\n    } catch (error) {\n      var message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n    }\n  });\n  return function (_x, _x2, _x3, _x4, _x5) {\n    return _ref.apply(this, arguments);\n  };\n}());\nexport var sendMess = createAsyncThunk('message/sendMesssage', function () {\n  var _ref2 = _asyncToGenerator(function* (event, newMessage, socket, selectedChat, user, setNewMessage, setMessages, messages) {\n    try {\n      return yield messageService.sendMess(event, newMessage, socket, selectedChat, user, setNewMessage, setMessages, messages);\n    } catch (error) {\n      var message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n    }\n  });\n  return function (_x6, _x7, _x8, _x9, _x10, _x11, _x12, _x13) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nexport var sendMessage = createAsyncThunk('message/send', function () {\n  var _ref3 = _asyncToGenerator(function* (content, thunkAPI) {\n    console.log(\"startin slice on \" + content);\n    try {\n      var token = thunkAPI.getState().auth.user.token;\n      return yield messageService.sendMessage(content, token);\n    } catch (error) {\n      var message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n      return thunkAPI.rejectWithValue(message);\n    }\n  });\n  return function (_x14, _x15) {\n    return _ref3.apply(this, arguments);\n  };\n}());\nexport var allMessages = createAsyncThunk('message/get', function () {\n  var _ref4 = _asyncToGenerator(function* (chatId, thunkAPI) {\n    try {\n      var token = thunkAPI.getState().auth.user.token;\n      console.log('fetching in messageSlice');\n      return yield messageService.allMessages(chatId, token);\n    } catch (error) {\n      var message = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n      return thunkAPI.rejectWithValue(message);\n    }\n  });\n  return function (_x16, _x17) {\n    return _ref4.apply(this, arguments);\n  };\n}());\nexport var messageSlice = createSlice({\n  name: 'mess',\n  initialState: initialState,\n  reducers: {\n    reset: function reset(state) {\n      return initialState;\n    }\n  },\n  extraReducers: function extraReducers(builder) {\n    builder.addCase(sendMessage.pending, function (state) {\n      state.isLoading = true;\n    }).addCase(sendMessage.fulfilled, function (state, action) {\n      state.isLoading = false;\n      state.isSuccess = true;\n      state.messages.push(action.payload);\n    }).addCase(sendMessage.rejected, function (state, action) {\n      state.isLoading = false;\n      state.isError = true;\n      state.message = action.payload;\n    }).addCase(sendMess.pending, function (state) {\n      state.isLoading = true;\n    }).addCase(sendMess.fulfilled, function (state, action) {\n      state.isLoading = false;\n      state.isSuccess = true;\n      state.messages.push(action.payload);\n    }).addCase(sendMess.rejected, function (state, action) {\n      state.isLoading = false;\n      state.isError = true;\n      state.message = action.payload;\n    }).addCase(allMessages.pending, function (state) {\n      state.isLoading = true;\n    }).addCase(allMessages.fulfilled, function (state, action) {\n      state.isLoading = false;\n      state.isSuccess = true;\n      state.messages = action.payload;\n    }).addCase(allMessages.rejected, function (state, action) {\n      state.isLoading = false;\n      state.isError = true;\n      state.message = action.payload;\n    }).addCase(fetchMessages.pending, function (state) {\n      state.isLoading = true;\n    }).addCase(fetchMessages.fulfilled, function (state, action) {\n      state.isLoading = false;\n      state.isSuccess = true;\n      state.messages = action.payload;\n    }).addCase(fetchMessages.rejected, function (state, action) {\n      state.isLoading = false;\n      state.isError = true;\n      state.message = action.payload;\n    });\n  }\n});\nvar reset = messageSlice.actions.reset;\nexport { reset };\nexport default messageSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","messageService","initialState","messages","isError","isSuccess","isLoading","fetchMessages","selectedChat","user","setLd","setMessages","socket","error","message","response","data","toString","sendMess","event","newMessage","setNewMessage","sendMessage","content","thunkAPI","console","log","token","getState","auth","rejectWithValue","allMessages","chatId","messageSlice","name","reducers","reset","state","extraReducers","builder","addCase","pending","fulfilled","action","push","payload","rejected","actions","reducer"],"sources":["/home/dagmawi/personal/borsa/myborsa/borsa-ui/src/features/message/messageSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit'\nimport messageService from './messageService'\n\nconst initialState = {\n    messages: [],\n    isError: false,\n    isSuccess: false,\n    isLoading: false,\n    messages: [],\n  }\n\n\nexport const fetchMessages = createAsyncThunk('message/fetch',\nasync(selectedChat, user, setLd, setMessages, socket) => {\ntry{\n  // const token = thunkAPI.getState().auth.user.token\n  return await messageService.fetchMessages(selectedChat, user, setLd, setMessages, socket)\n}\ncatch (error) {\n  const message =\n    (error.response &&\n      error.response.data &&\n      error.response.data.message) ||\n    error.message ||\n    error.toString()\n    // return thunkAPI.rejectWithValue(message)\n    }\n}\n)\nexport const sendMess = createAsyncThunk('message/sendMesssage',\nasync(event, newMessage, socket, selectedChat, user, setNewMessage,setMessages,  messages) => {\ntry{\n  // const token = thunkAPI.getState().auth.user.token\n  return await messageService.sendMess(event, newMessage, socket, selectedChat, user, setNewMessage,setMessages,  messages)\n\n}\ncatch (error) {\n  const message =\n    (error.response &&\n      error.response.data &&\n      error.response.data.message) ||\n    error.message ||\n    error.toString()\n    // return thunkAPI.rejectWithValue(message)\n    }\n}\n)\n  export const sendMessage = createAsyncThunk(\n    'message/send',\n    async (content, thunkAPI) => {\n      console.log(`startin slice on ${content}`)\n  \n      try {\n        const token = thunkAPI.getState().auth.user.token\n        return await messageService.sendMessage(content, token)\n      } catch (error) {\n        const message =\n          (error.response &&\n            error.response.data &&\n            error.response.data.message) ||\n          error.message ||\n          error.toString()\n        return thunkAPI.rejectWithValue(message)\n      }\n    }\n  )\n\n\n  export const allMessages = createAsyncThunk(\n    'message/get',\n    async (chatId, thunkAPI) => {\n      try {\n        const token = thunkAPI.getState().auth.user.token\n        console.log('fetching in messageSlice')\n        return await messageService.allMessages(chatId, token)\n      } catch (error) {\n        const message =\n          (error.response &&\n            error.response.data &&\n            error.response.data.message) ||\n          error.message ||\n          error.toString()\n        return thunkAPI.rejectWithValue(message)\n      }\n    }\n  )\n\n  export const messageSlice = createSlice({\n    name: 'mess',\n    initialState,\n    reducers: {\n      reset: (state) => initialState,\n    },\n    extraReducers: (builder) => {\n      builder\n        .addCase(sendMessage.pending, (state) => {\n          state.isLoading = true\n        })\n        .addCase(sendMessage.fulfilled, (state, action) => {\n          state.isLoading = false\n          state.isSuccess = true\n          state.messages.push(action.payload)\n        })\n        .addCase(sendMessage.rejected, (state, action) => {\n          state.isLoading = false\n          state.isError = true\n          state.message = action.payload\n        })\n        .addCase(sendMess.pending, (state) => {\n          state.isLoading = true\n        })\n        .addCase(sendMess.fulfilled, (state, action) => {\n          state.isLoading = false\n          state.isSuccess = true\n          state.messages.push(action.payload)\n        })\n        .addCase(sendMess.rejected, (state, action) => {\n          state.isLoading = false\n          state.isError = true\n          state.message = action.payload\n        })\n        .addCase(allMessages.pending, (state) => {\n          state.isLoading = true\n        })\n        .addCase(allMessages.fulfilled, (state, action) => {\n          state.isLoading = false\n          state.isSuccess = true\n          state.messages = action.payload\n        })\n        .addCase(allMessages.rejected, (state, action) => {\n          state.isLoading = false\n          state.isError = true\n          state.message = action.payload\n        })\n        .addCase(fetchMessages.pending, (state) => {\n          state.isLoading = true\n        })\n        .addCase(fetchMessages.fulfilled, (state, action) => {\n          state.isLoading = false\n          state.isSuccess = true\n          state.messages = action.payload\n        })\n        .addCase(fetchMessages.rejected, (state, action) => {\n          state.isLoading = false\n          state.isError = true\n          state.message = action.payload\n        })\n    },\n  })\n  \n  export const { reset } = messageSlice.actions\n  export default messageSlice.reducer\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}